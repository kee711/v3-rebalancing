<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Aerodrome Rebalance Vault - Backtest</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Source+Serif+4:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="glow"></div>
    <header class="hero">
      <div class="hero-left">
        <p class="eyebrow">Base Â· Aerodrome</p>
        <h1>Rebalancing Vault Backtest</h1>
        <p class="subhead">
          Automated range management, trend skew, and reward compounding with a fast backtest pipeline.
        </p>
        <div class="hero-actions">
          <button id="runBtn" class="primary">Run Backtest</button>
          <span id="status" class="status">Ready</span>
        </div>
      </div>
      <div class="hero-right">
        <div class="metric-tile" data-animate>
          <h3>Pool</h3>
          <p id="poolLabel">-</p>
        </div>
        <div class="metric-tile" data-animate>
          <h3>Data Points</h3>
          <p id="dataPoints">-</p>
        </div>
        <div class="metric-tile" data-animate>
          <h3>Period</h3>
          <p id="dataPeriod">-</p>
        </div>
        <div class="metric-tile" data-animate>
          <h3>Last Price</h3>
          <p id="lastPrice">-</p>
        </div>
        <div class="metric-tile" data-animate>
          <h3>Volatility</h3>
          <p id="lastVol">-</p>
        </div>
        <div class="metric-tile" data-animate>
          <h3>Rebalances</h3>
          <p id="rebalanceCount">-</p>
        </div>
      </div>
    </header>

    <main>
      <!-- Data Evidence Section -->
      <section class="evidence-section" data-animate>
        <div class="card evidence-card">
          <h2>ðŸ“Š Backtest Evidence</h2>
          <div class="evidence-grid">
            <div class="evidence-item">
              <span class="label">Data Source</span>
              <span class="value" id="dataSource">-</span>
            </div>
            <div class="evidence-item">
              <span class="label">Subgraph</span>
              <span class="value" id="subgraphInfo">-</span>
            </div>
            <div class="evidence-item">
              <span class="label">Start Date</span>
              <span class="value" id="startDate">-</span>
            </div>
            <div class="evidence-item">
              <span class="label">End Date</span>
              <span class="value" id="endDate">-</span>
            </div>
            <div class="evidence-item">
              <span class="label">Hours Analyzed</span>
              <span class="value" id="hoursAnalyzed">-</span>
            </div>
            <div class="evidence-item">
              <span class="label">Generated At</span>
              <span class="value" id="generatedAt">-</span>
            </div>
          </div>
        </div>
      </section>

      <section class="grid">
        <div class="card" data-animate>
          <h2>Performance</h2>
          <div class="stats">
            <div>
              <span>Start Value</span>
              <strong id="startValue">-</strong>
            </div>
            <div>
              <span>End Value</span>
              <strong id="endValue">-</strong>
            </div>
            <div>
              <span>Profit/Loss</span>
              <strong id="profitLoss">-</strong>
            </div>
          </div>
          <div class="stats">
            <div>
              <span>Total Return</span>
              <strong id="totalReturn">-</strong>
            </div>
            <div>
              <span>Annualized</span>
              <strong id="annualized">-</strong>
            </div>
            <div>
              <span>Max Drawdown</span>
              <strong id="maxDrawdown">-</strong>
            </div>
          </div>
          <div class="stats">
            <div>
              <span>Fees Earned</span>
              <strong id="fees">-</strong>
            </div>
            <div>
              <span>Emissions</span>
              <strong id="emissions">-</strong>
            </div>
            <div>
              <span>Gas Spent</span>
              <strong id="gas">-</strong>
            </div>
          </div>
        </div>
        <div class="card" data-animate>
          <h2>Equity Curve (Your Portfolio Value Over Time)</h2>
          <canvas id="equityChart" height="140"></canvas>
        </div>
      </section>

      <section class="grid">
        <div class="card" data-animate>
          <h2>Price Chart (Actual Market Data)</h2>
          <canvas id="priceChart" height="140"></canvas>
        </div>
      </section>

      <section class="grid">
        <div class="card" data-animate>
          <h2>All Rebalance Actions (<span id="totalActions">0</span> total)</h2>
          <div class="actions-scroll">
            <table>
              <thead>
                <tr>
                  <th>#</th>
                  <th>Time</th>
                  <th>Strategy</th>
                  <th>Reason</th>
                  <th>Actions</th>
                  <th>Gas</th>
                </tr>
              </thead>
              <tbody id="actionsBody"></tbody>
            </table>
          </div>
          <div class="actions-summary">
            <p id="actionsSummary">-</p>
          </div>
        </div>
        <div class="card" data-animate>
          <h2>Config Used</h2>
          <pre id="configDump">-</pre>
        </div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="/app.js"></script>
  </body>
</html>
